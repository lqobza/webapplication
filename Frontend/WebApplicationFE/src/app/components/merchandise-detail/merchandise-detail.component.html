<div *ngIf="!merchandise && isLoading">Loading...</div>
<div *ngIf="!merchandise && !isLoading && errorMessage">Error: {{ errorMessage }}</div>

<div class="merchandise-details" *ngIf="merchandise">
  <div class="details-header">
    <h2>{{ merchandise.name }}</h2>
    <button (click)="goToUpdatePage(merchandise.id)" class="edit-button">Edit</button> 
  </div>
  <p>Price: {{ merchandise.price }}</p>
  <p>Description: {{ merchandise.description }}</p>
  <p>Brand: {{ merchandise.brandName }}</p>

  <div *ngIf="merchandise.ratings && merchandise.ratings.length > 0">
    <h3>Ratings</h3>
    <ul>
      <li *ngFor="let rating of merchandise.ratings">
        {{ rating.rating }} - {{ rating.description }}
      </li>
    </ul>
  </div>

  <div *ngIf="merchandise.themes && merchandise.themes.length > 0">
    <h3>Themes</h3>
    <ul>
      <li *ngFor="let theme of merchandise.themes">
        {{ theme.name }}
      </li>
    </ul>
  </div>

  <div *ngIf="merchandise.sizes && merchandise.sizes.length > 0">
    <h3 *ngIf="hasMultipleSizes">Sizes</h3>
  
    <!-- Only show dropdown if there are multiple sizes and names are not null -->
    <select *ngIf="hasMultipleSizes" [(ngModel)]="selectedSize" (change)="onSizeChange()">
      <option *ngFor="let size of merchandise.sizes" [ngValue]="size.size">
        {{ size.size }}
      </option>
    </select>
  
    <!-- Display stock info for single-size merchandise where size name is null -->
    <div class="in-stock" *ngIf="!hasMultipleSizes && merchandise.sizes.length === 1">
      In Stock: {{ inStock }}
    </div>
  
    <!-- Display stock info for selected size -->
    <div class="in-stock" *ngIf="selectedSize && hasMultipleSizes">
      In Stock: {{ getInStock(selectedSize) }}
    </div>
  
    <!-- Quantity and Add to Cart for BOTH multiple sizes and single-size cases -->
    <div class="quantity-section" *ngIf="(selectedSize || merchandise.sizes.length === 1) && isAddToCartEnabled">
      <label for="quantity">Quantity:</label>
      <input type="number" id="quantity" name="quantity" [(ngModel)]="quantity"
             min="1" [max]="maxQuantity" (change)="onQuantityChange()">
      <button (click)="addToCart()" [disabled]="isAddToCartDisabled">Add to Cart</button> </div>
  
    <div class="out-of-stock" *ngIf="(selectedSize || merchandise.sizes.length === 1) && isOutOfStock()">
      <p>Out of stock</p>
    </div>
  </div>
  
</div>